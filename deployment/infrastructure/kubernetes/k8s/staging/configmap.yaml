apiVersion: v1
kind: ConfigMap
metadata:
  name: pynomaly-staging-config
  namespace: pynomaly-staging
  labels:
    app: pynomaly
    component: config
    environment: staging
data:
  PYNOMALY_ENV: "staging"
  PYNOMALY_DEBUG: "false"
  PYNOMALY_LOG_LEVEL: "DEBUG"
  PYNOMALY_API_HOST: "0.0.0.0"
  PYNOMALY_API_PORT: "8000"
  PROMETHEUS_ENABLED: "true"
  METRICS_ENDPOINT: "/metrics"
  HEALTH_CHECK_ENDPOINT: "/health"
  REDIS_HOST: "redis-staging-service"
  REDIS_PORT: "6379"
  POSTGRES_HOST: "postgres-staging-service"
  POSTGRES_PORT: "5432"
  POSTGRES_DB: "pynomaly_staging"
  MONGODB_HOST: "mongodb-staging-service"
  MONGODB_PORT: "27017"
  MONGODB_DB: "pynomaly_staging"
  
  # Staging-specific settings
  ENABLE_SWAGGER: "true"
  ENABLE_DEBUG_ENDPOINTS: "true"
  RATE_LIMIT_ENABLED: "true"
  RATE_LIMIT_REQUESTS: "1000"
  RATE_LIMIT_PERIOD: "3600"
  
  # Feature flags for staging
  FEATURE_NEW_ALGORITHMS: "true"
  FEATURE_EXPERIMENTAL_UI: "true"
  FEATURE_ADVANCED_MONITORING: "true"
  
  # Load testing configuration
  LOAD_TEST_MODE: "true"
  MAX_CONCURRENT_REQUESTS: "500"
  DATABASE_POOL_SIZE: "50"
  
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: pynomaly-staging-test-config
  namespace: pynomaly-staging
  labels:
    app: pynomaly
    component: test-config
    environment: staging
data:
  # Test data configuration
  TEST_DATA_SIZE: "10000"
  TEST_BATCH_SIZE: "1000"
  TEST_CONCURRENT_USERS: "100"
  TEST_DURATION_MINUTES: "30"
  
  # Performance test thresholds
  RESPONSE_TIME_P95_MS: "500"
  RESPONSE_TIME_P99_MS: "1000"
  ERROR_RATE_THRESHOLD: "0.01"
  THROUGHPUT_MIN_RPS: "100"
  
  # Load test scenarios
  LOAD_TEST_SCENARIOS: |
    scenarios:
      - name: "basic_detection"
        weight: 60
        endpoint: "/api/v1/detect"
        method: "POST"
        concurrent_users: 50
      - name: "model_training"
        weight: 20
        endpoint: "/api/v1/train"
        method: "POST"
        concurrent_users: 10
      - name: "data_upload"
        weight: 15
        endpoint: "/api/v1/datasets"
        method: "POST"
        concurrent_users: 15
      - name: "health_check"
        weight: 5
        endpoint: "/health"
        method: "GET"
        concurrent_users: 25
