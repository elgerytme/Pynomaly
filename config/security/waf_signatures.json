{
  "signatures": [
    {
      "name": "Advanced SQL Injection - Time-based",
      "pattern": "(?:sleep\\s*\\(\\s*\\d+\\s*\\)|benchmark\\s*\\(\\s*\\d+\\s*,|pg_sleep\\s*\\(\\s*\\d+\\s*\\)|waitfor\\s+delay\\s+['\"]\\d+:['\"])",
      "attack_type": "sql_injection",
      "threat_level": "critical",
      "description": "Detects time-based SQL injection attacks",
      "enabled": true
    },
    {
      "name": "NoSQL Injection - MongoDB",
      "pattern": "(?:\\$where|\\$ne|\\$in|\\$nin|\\$gt|\\$lt|\\$regex|\\$exists|\\$type|\\$size|\\$all|\\$elemMatch)",
      "attack_type": "sql_injection",
      "threat_level": "high",
      "description": "Detects MongoDB NoSQL injection attempts",
      "enabled": true
    },
    {
      "name": "XSS - DOM-based",
      "pattern": "(?:document\\.write|document\\.writeln|innerHTML|outerHTML|insertAdjacentHTML|eval|setTimeout|setInterval)\\s*\\(",
      "attack_type": "xss",
      "threat_level": "high",
      "description": "Detects DOM-based XSS attempts",
      "enabled": true
    },
    {
      "name": "XSS - CSS Injection",
      "pattern": "(?:expression\\s*\\(|@import|javascript:|vbscript:|data:text/html|<style|</style>)",
      "attack_type": "xss",
      "threat_level": "medium",
      "description": "Detects CSS injection attempts",
      "enabled": true
    },
    {
      "name": "LDAP Injection",
      "pattern": "(?:\\*\\)|\\(\\|\\(|\\(\\&\\(|\\(\\!\\(|\\)\\(|\\*\\(|\\(cn=|\\(uid=|\\(mail=)",
      "attack_type": "sql_injection",
      "threat_level": "high",
      "description": "Detects LDAP injection attempts",
      "enabled": true
    },
    {
      "name": "XML External Entity (XXE)",
      "pattern": "(?:<!ENTITY|<!DOCTYPE|SYSTEM\\s+['\"]|PUBLIC\\s+['\"]|\\&\\w+;)",
      "attack_type": "command_injection",
      "threat_level": "high",
      "description": "Detects XXE injection attempts",
      "enabled": true
    },
    {
      "name": "Server-Side Template Injection",
      "pattern": "(?:\\{\\{.*\\}\\}|\\{%.*%\\}|\\$\\{.*\\}|<%.*%>|\\[\\[.*\\]\\]|#\\{.*\\})",
      "attack_type": "command_injection",
      "threat_level": "high",
      "description": "Detects SSTI attempts",
      "enabled": true
    },
    {
      "name": "Deserialization Attack",
      "pattern": "(?:java\\.lang\\.Runtime|java\\.lang\\.ProcessBuilder|eval\\(|exec\\(|__reduce__|pickle\\.loads|yaml\\.load|json\\.loads)",
      "attack_type": "command_injection",
      "threat_level": "critical",
      "description": "Detects deserialization attacks",
      "enabled": true
    },
    {
      "name": "Log4j Vulnerability (Log4Shell)",
      "pattern": "(?:\\$\\{jndi:|\\$\\{ldap:|\\$\\{rmi:|\\$\\{dns:|\\$\\{nis:|\\$\\{nds:|\\$\\{corba:|\\$\\{iiop:)",
      "attack_type": "command_injection",
      "threat_level": "critical",
      "description": "Detects Log4j RCE attempts",
      "enabled": true
    },
    {
      "name": "Spring4Shell Vulnerability",
      "pattern": "(?:class\\.module\\.classLoader|class\\.classLoader|getClass\\(\\)\\.getClassLoader|Runtime\\.getRuntime\\(\\)\\.exec)",
      "attack_type": "command_injection",
      "threat_level": "critical",
      "description": "Detects Spring4Shell RCE attempts",
      "enabled": true
    },
    {
      "name": "Struts2 Vulnerability",
      "pattern": "(?:#_memberAccess|ognl\\.|@java\\.lang\\.Runtime|@java\\.lang\\.ProcessBuilder|\\%\\{|\\$\\{)",
      "attack_type": "command_injection",
      "threat_level": "critical",
      "description": "Detects Struts2 RCE attempts",
      "enabled": true
    },
    {
      "name": "PHP Code Injection",
      "pattern": "(?:preg_replace.*\\/e|assert\\s*\\(|file_get_contents\\s*\\(|fopen\\s*\\(|fwrite\\s*\\(|include\\s*\\(|require\\s*\\(|eval\\s*\\(|create_function\\s*\\()",
      "attack_type": "command_injection",
      "threat_level": "high",
      "description": "Detects PHP code injection attempts",
      "enabled": true
    },
    {
      "name": "Python Code Injection",
      "pattern": "(?:__import__|exec\\s*\\(|eval\\s*\\(|compile\\s*\\(|os\\.system|subprocess\\.|popen\\(|getattr\\(|setattr\\(|delattr\\()",
      "attack_type": "command_injection",
      "threat_level": "high",
      "description": "Detects Python code injection attempts",
      "enabled": true
    },
    {
      "name": "JavaScript Code Injection",
      "pattern": "(?:Function\\s*\\(|eval\\s*\\(|setTimeout\\s*\\(|setInterval\\s*\\(|execScript\\s*\\(|new\\s+Function\\s*\\()",
      "attack_type": "command_injection",
      "threat_level": "high",
      "description": "Detects JavaScript code injection attempts",
      "enabled": true
    },
    {
      "name": "Remote File Inclusion",
      "pattern": "(?:https?://|ftp://|file://|php://|data://|zip://|glob://|phar://|ssh2://|rar://|ogg://|expect://)",
      "attack_type": "path_traversal",
      "threat_level": "high",
      "description": "Detects remote file inclusion attempts",
      "enabled": true
    },
    {
      "name": "Local File Inclusion",
      "pattern": "(?:\\.\\./|\\.\\.\\\\|%2e%2e%2f|%2e%2e%5c|\\.\\.%2f|\\.\\.%5c|%2e%2e/|%2e%2e\\\\)",
      "attack_type": "path_traversal",
      "threat_level": "high",
      "description": "Detects local file inclusion attempts",
      "enabled": true
    },
    {
      "name": "CSRF Token Bypass",
      "pattern": "(?:csrf_token=|_token=|authenticity_token=|__RequestVerificationToken=|csrfmiddlewaretoken=)",
      "attack_type": "csrf",
      "threat_level": "medium",
      "description": "Detects CSRF token manipulation attempts",
      "enabled": true
    },
    {
      "name": "Session Hijacking",
      "pattern": "(?:JSESSIONID=|PHPSESSID=|ASP\\.NET_SessionId=|session_id=|sid=)",
      "attack_type": "csrf",
      "threat_level": "medium",
      "description": "Detects session hijacking attempts",
      "enabled": true
    },
    {
      "name": "Clickjacking Attempt",
      "pattern": "(?:X-Frame-Options|frame-src|frame-ancestors|allowfullscreen|sandbox)",
      "attack_type": "xss",
      "threat_level": "low",
      "description": "Detects clickjacking attempts",
      "enabled": true
    },
    {
      "name": "HTTP Parameter Pollution",
      "pattern": "(?:&[a-zA-Z0-9_]+=[^&]*&[a-zA-Z0-9_]+=|\\?[a-zA-Z0-9_]+=[^&]*&[a-zA-Z0-9_]+=.*&[a-zA-Z0-9_]+=)",
      "attack_type": "protocol_violation",
      "threat_level": "medium",
      "description": "Detects HTTP parameter pollution",
      "enabled": true
    },
    {
      "name": "HTTP Request Smuggling",
      "pattern": "(?:Transfer-Encoding:\\s*chunked|Content-Length:\\s*0\\s*\\r\\n.*Content-Length:|Connection:\\s*close\\s*\\r\\n.*Connection:)",
      "attack_type": "protocol_violation",
      "threat_level": "high",
      "description": "Detects HTTP request smuggling",
      "enabled": true
    },
    {
      "name": "Web Shell Detection",
      "pattern": "(?:c99shell|r57shell|webshell|backdoor|shell_exec|passthru|system|exec|popen|proc_open|base64_decode\\(|gzinflate\\(|str_rot13\\()",
      "attack_type": "malware",
      "threat_level": "critical",
      "description": "Detects web shell uploads",
      "enabled": true
    },
    {
      "name": "Cryptojacking Detection",
      "pattern": "(?:cryptonight|stratum\\+tcp|mining|hashrate|monero|bitcoin|cryptocurrency|coinhive|jsecoin|webminer)",
      "attack_type": "malware",
      "threat_level": "high",
      "description": "Detects cryptojacking attempts",
      "enabled": true
    },
    {
      "name": "Advanced Persistent Threat (APT)",
      "pattern": "(?:powershell\\.exe|cmd\\.exe|rundll32\\.exe|regsvr32\\.exe|mshta\\.exe|wscript\\.exe|cscript\\.exe)",
      "attack_type": "malware",
      "threat_level": "critical",
      "description": "Detects APT-style attacks",
      "enabled": true
    },
    {
      "name": "Automated Scanner - Comprehensive",
      "pattern": "(?:nmap|masscan|zmap|nikto|dirb|dirbuster|gobuster|wpscan|sqlmap|burp|owasp-zap|acunetix|nessus|openvas|w3af|skipfish|wapiti|arachni)",
      "attack_type": "scanner",
      "threat_level": "medium",
      "description": "Detects various security scanners",
      "enabled": true
    },
    {
      "name": "Bot Detection - Malicious",
      "pattern": "(?:python-requests|curl|wget|libwww-perl|httpclient|okhttp|go-http-client|java|ruby|scrapy|selenium|phantomjs|headless)",
      "attack_type": "malicious_bot",
      "threat_level": "low",
      "description": "Detects automated bots",
      "enabled": true
    },
    {
      "name": "Credential Stuffing",
      "pattern": "(?:login|password|username|email).*(?:admin|administrator|root|test|guest|user|demo|123456|password|qwerty)",
      "attack_type": "brute_force",
      "threat_level": "medium",
      "description": "Detects credential stuffing attempts",
      "enabled": true
    },
    {
      "name": "Business Logic Bypass",
      "pattern": "(?:price=[0-9]*\\.?[0-9]*&|amount=[0-9]*\\.?[0-9]*&|quantity=[0-9]*\\.?[0-9]*&|discount=[0-9]*\\.?[0-9]*&)",
      "attack_type": "anomaly",
      "threat_level": "medium",
      "description": "Detects business logic manipulation",
      "enabled": true
    },
    {
      "name": "API Abuse Detection",
      "pattern": "(?:\\/api\\/.*\\?.*\\&.*\\&.*\\&|x-api-key|authorization:\\s*bearer|x-auth-token)",
      "attack_type": "scanner",
      "threat_level": "low",
      "description": "Detects API abuse patterns",
      "enabled": true
    },
    {
      "name": "GraphQL Injection",
      "pattern": "(?:__schema|__type|__typename|__field|__directive|__args|__inputValue|__enumValue|query\\s*\\{|mutation\\s*\\{|subscription\\s*\\{)",
      "attack_type": "sql_injection",
      "threat_level": "medium",
      "description": "Detects GraphQL injection attempts",
      "enabled": true
    }
  ]
}