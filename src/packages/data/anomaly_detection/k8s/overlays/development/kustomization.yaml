apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: pynomaly-development

resources:
- ../../base

images:
- name: pynomaly/detection
  newTag: v0.2.0-dev

replicas:
- name: pynomaly-detection
  count: 1

patchesStrategicMerge:
- deployment-patch.yaml
- service-patch.yaml
- hpa-patch.yaml

commonLabels:
  environment: development
  tier: development

commonAnnotations:
  environment: development
  deployed-by: developer

configMapGenerator:
- name: pynomaly-config-development
  literals:
  - PYNOMALY_ENV=development
  - PYNOMALY_LOG_LEVEL=DEBUG
  - PYNOMALY_WORKERS=2
  - PYNOMALY_MEMORY_LIMIT_GB=2
  - PYNOMALY_BATCH_SIZE=500
  - PYNOMALY_PARALLEL_JOBS=2
  - PYNOMALY_ENABLE_METRICS=true
  - PYNOMALY_ENABLE_CACHE=false

secretGenerator:
- name: pynomaly-secrets-development
  literals:
  - PYNOMALY_DB_HOST=localhost
  - PYNOMALY_REDIS_HOST=localhost
  - PYNOMALY_S3_BUCKET=pynomaly-dev-data
  - PYNOMALY_S3_REGION=us-east-1