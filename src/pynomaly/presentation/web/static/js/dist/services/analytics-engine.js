(()=>{var T=(p,e)=>()=>(e||p((e={exports:{}}).exports,e),e.exports);var _=T((z,w)=>{var c=class{static mean(e){return e.length===0?0:e.reduce((t,s)=>t+s,0)/e.length}static median(e){if(e.length===0)return 0;let t=[...e].sort((n,r)=>n-r),s=Math.floor(t.length/2);return t.length%2===0?(t[s-1]+t[s])/2:t[s]}static standardDeviation(e){if(e.length<2)return 0;let t=this.mean(e),s=e.reduce((n,r)=>n+Math.pow(r-t,2),0)/(e.length-1);return Math.sqrt(s)}static percentile(e,t){if(e.length===0)return 0;let s=[...e].sort((a,o)=>a-o),n=t/100*(s.length-1),r=Math.floor(n),i=Math.ceil(n);return r===i?s[r]:s[r]*(i-n)+s[i]*(n-r)}static zScore(e,t,s){return s===0?0:(e-t)/s}static correlationCoefficient(e,t){if(e.length!==t.length||e.length<2)return 0;let s=this.mean(e),n=this.mean(t),r=0,i=0,a=0;for(let l=0;l<e.length;l++){let h=e[l]-s,d=t[l]-n;r+=h*d,i+=h*h,a+=d*d}let o=Math.sqrt(i*a);return o===0?0:r/o}static linearRegression(e,t){if(e.length!==t.length||e.length<2)return{slope:0,intercept:0,r2:0};let s=e.length,n=e.reduce((m,u)=>m+u,0),r=t.reduce((m,u)=>m+u,0),i=e.reduce((m,u,v)=>m+u*t[v],0),a=e.reduce((m,u)=>m+u*u,0),o=t.reduce((m,u)=>m+u*u,0),l=(s*i-n*r)/(s*a-n*n),h=(r-l*n)/s,d=r/s,g=e.reduce((m,u,v)=>{let D=l*u+h;return m+Math.pow(D-d,2)},0),y=t.reduce((m,u)=>m+Math.pow(u-d,2),0),M=y===0?1:g/y;return{slope:l,intercept:h,r2:M}}static exponentialSmoothing(e,t=.3){if(e.length===0)return[];let s=[e[0]];for(let n=1;n<e.length;n++)s[n]=t*e[n]+(1-t)*s[n-1];return s}static movingAverage(e,t){if(e.length<t)return e.slice();let s=[];for(let n=0;n<=e.length-t;n++){let r=e.slice(n,n+t);s.push(this.mean(r))}return s}},f=class{constructor(e={}){this.options={minDataPoints:10,trendThreshold:.05,significanceLevel:.05,seasonalityWindow:24,changePointSensitivity:2,...e},this.trendHistory=[],this.seasonalPatterns=new Map,this.changePoints=[]}analyzeTrend(e,t=null){if(e.length<this.options.minDataPoints)return{type:"insufficient_data",confidence:0,message:"Not enough data points for trend analysis"};let s=t?t.map(h=>new Date(h).getTime()):e.map((h,d)=>d),n=c.linearRegression(s,e),r=this.classifyTrend(n,e),i=this.detectSeasonality(e,t),a=this.detectChangePoints(e),o=this.calculateTrendStrength(e,n),l={...r,regression:n,seasonality:i,changePoints:a,trendStrength:o,dataPoints:e.length,timespan:t?{start:new Date(Math.min(...t)),end:new Date(Math.max(...t)),duration:Math.max(...t)-Math.min(...t)}:null};return this.trendHistory.push({timestamp:Date.now(),analysis:l}),l}classifyTrend(e,t){let{slope:s,r2:n}=e,r=Math.abs(s),i=Math.max(...t)-Math.min(...t),a=i>0?r/i:0,o,l,h,d;return Math.abs(s)<this.options.trendThreshold?(h="stable",o="stable"):s>0?(h="increasing",o="upward"):(h="decreasing",o="downward"),a<.01?d="weak":a<.05?d="moderate":d="strong",l=Math.min(n*100,95),{type:o,direction:h,strength:d,confidence:Math.round(l),slope:s,normalizedSlope:a,message:this.generateTrendMessage(o,d,l)}}detectSeasonality(e,t){if(!t||e.length<this.options.seasonalityWindow*2)return{detected:!1,message:"Insufficient data for seasonality detection"};let s={};t.forEach((h,d)=>{let g=new Date(h).getHours();s[g]||(s[g]=[]),s[g].push(e[d])});let n={};Object.keys(s).forEach(h=>{n[h]=c.mean(s[h])});let r=Object.values(n),i=c.mean(r),o=c.standardDeviation(r)/Math.abs(i),l=o>.1;return{detected:l,patterns:n,variation:o,peak:l?this.findPeakHour(n):null,message:l?`Seasonal pattern detected with ${(o*100).toFixed(1)}% variation`:"No significant seasonal pattern detected"}}findPeakHour(e){let t=null,s=-1/0;return Object.entries(e).forEach(([n,r])=>{r>s&&(s=r,t=parseInt(n))}),{hour:t,value:s}}detectChangePoints(e){if(e.length<10)return[];let t=[],s=Math.max(3,Math.floor(e.length/10));for(let n=s;n<e.length-s;n++){let r=e.slice(n-s,n),i=e.slice(n,n+s),a=c.mean(r),o=c.mean(i),l=c.standardDeviation(r),h=c.standardDeviation(i),d=Math.abs(o-a),g=Math.sqrt((l*l+h*h)/2);if(g>0){let y=d/g;y>this.options.changePointSensitivity&&t.push({index:n,magnitude:y,before:a,after:o,change:o-a,changePercent:a!==0?(o-a)/a*100:0})}}return t}calculateTrendStrength(e,t){let{r2:s}=t,n=c.standardDeviation(e),r=c.mean(e),i=Math.abs(r)>0?n/Math.abs(r):0;return{r_squared:s,coefficient_of_variation:i,strength_score:s/(1+i),interpretation:this.interpretTrendStrength(s,i)}}interpretTrendStrength(e,t){return e>.8&&t<.2?"Very Strong":e>.6&&t<.4?"Strong":e>.4&&t<.6?"Moderate":e>.2?"Weak":"Very Weak"}generateTrendMessage(e,t,s){return`${t==="weak"?"slight":t} ${e} trend detected with ${s}% confidence`}getTrendHistory(e=10){return this.trendHistory.slice(-e)}clearHistory(){this.trendHistory=[],this.seasonalPatterns.clear(),this.changePoints=[]}},A=class{constructor(e={}){this.options={alertThresholds:{critical:{zScore:3,trendChange:50},high:{zScore:2.5,trendChange:30},medium:{zScore:2,trendChange:20},low:{zScore:1.5,trendChange:10}},cooldownPeriod:5*60*1e3,maxAlertsPerHour:10,enableAdaptiveThresholds:!0,...e},this.alerts=[],this.alertHistory=[],this.suppressedAlerts=new Set,this.adaptiveThresholds=new Map}analyzeForAlerts(e,t={}){let s=Date.now(),n=[],r=this.detectOutlierAlerts(e,t);if(n.push(...r),e.length>=10){let l=this.detectTrendAlerts(e,t);n.push(...l)}let i=this.detectVolumeAlerts(e,t);n.push(...i);let a=this.detectChangeRateAlerts(e,t);n.push(...a);let o=this.processAlerts(n,s);return this.alertHistory.push({timestamp:s,alerts:o,dataPoints:e.length,metadata:t}),o}detectOutlierAlerts(e,t){if(e.length<3)return[];let s=[],n=c.mean(e),r=c.standardDeviation(e),i=e.slice(-5);return i.forEach((a,o)=>{let l=c.zScore(a,n,r),h=this.classifyZScoreSeverity(Math.abs(l));h&&s.push({type:"statistical_outlier",severity:h,value:a,zScore:l,mean:n,stdDev:r,message:`Statistical outlier detected: value ${a.toFixed(3)} is ${Math.abs(l).toFixed(2)} standard deviations from mean`,metadata:{index:e.length-i.length+o,...t}})}),s}detectTrendAlerts(e,t){let n=new f().analyzeTrend(e),r=[];return n.confidence>70&&(n.strength==="strong"&&r.push({type:"trend_change",severity:n.type==="stable"?"low":"medium",trend:n,message:`Strong ${n.direction} trend detected with ${n.confidence}% confidence`,metadata:t}),n.changePoints&&n.changePoints.length>0&&n.changePoints.filter(a=>Math.abs(a.changePercent)>20).forEach(a=>{r.push({type:"change_point",severity:Math.abs(a.changePercent)>50?"high":"medium",changePoint:a,message:`Significant change detected: ${a.changePercent.toFixed(1)}% change at data point ${a.index}`,metadata:t})})),r}detectVolumeAlerts(e,t){let s=[],n=Math.min(20,Math.floor(e.length*.2));if(e.length<n*2)return s;let r=e.slice(-n),i=e.slice(0,-n),a=c.mean(r),o=c.mean(i),l=o!==0?(a-o)/o*100:0;return Math.abs(l)>25&&s.push({type:"volume_change",severity:Math.abs(l)>50?"high":"medium",changePercent:l,recentMean:a,historicalMean:o,message:`Significant volume change: ${l>0?"increase":"decrease"} of ${Math.abs(l).toFixed(1)}%`,metadata:t}),s}detectChangeRateAlerts(e,t){if(e.length<5)return[];let s=[],n=[];for(let a=e.length-4;a<e.length;a++)if(a>0){let o=Math.abs((e[a]-e[a-1])/e[a-1])*100;n.push(o)}let r=c.mean(n),i=Math.max(...n);return i>20&&s.push({type:"rapid_change",severity:i>50?"critical":i>30?"high":"medium",maxChangeRate:i,avgChangeRate:r,message:`Rapid change detected: maximum ${i.toFixed(1)}% change between consecutive points`,metadata:t}),s}classifyZScoreSeverity(e){return e>=this.options.alertThresholds.critical.zScore?"critical":e>=this.options.alertThresholds.high.zScore?"high":e>=this.options.alertThresholds.medium.zScore?"medium":e>=this.options.alertThresholds.low.zScore?"low":null}processAlerts(e,t){let s=e.filter(i=>!this.isAlertSuppressed(i)),r=this.applyRateLimit(s,t).map(i=>({...i,id:this.generateAlertId(),timestamp:t,acknowledged:!1}));return this.alerts.push(...r),this.cleanupOldAlerts(),r}isAlertSuppressed(e){let t=`${e.type}_${e.severity}`,s=this.suppressedAlerts.get(t);return s?Date.now()-s.timestamp>this.options.cooldownPeriod?(this.suppressedAlerts.delete(t),!1):!0:!1}applyRateLimit(e,t){let s=t-36e5;return this.alertHistory.filter(i=>i.timestamp>s).reduce((i,a)=>i+a.alerts.length,0)>=this.options.maxAlertsPerHour?e.filter(i=>i.severity==="critical"):e}acknowledgeAlert(e){let t=this.alerts.find(s=>s.id===e);if(t){t.acknowledged=!0,t.acknowledgedAt=Date.now();let s=`${t.type}_${t.severity}`;return this.suppressedAlerts.set(s,{timestamp:Date.now(),alertId:e}),!0}return!1}getActiveAlerts(e=null){let t=this.alerts.filter(s=>!s.acknowledged);return e&&(t=t.filter(s=>s.severity===e)),t.sort((s,n)=>{let r={critical:4,high:3,medium:2,low:1};return r[n.severity]-r[s.severity]})}getAlertHistory(e=100){return this.alertHistory.slice(-e)}generateAlertId(){return`alert_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}cleanupOldAlerts(){let e=Date.now()-864e5;this.alerts=this.alerts.filter(t=>t.timestamp>e),this.alertHistory=this.alertHistory.filter(t=>t.timestamp>e)}getAlertStatistics(){let e=this.getActiveAlerts(),t={critical:0,high:0,medium:0,low:0};return e.forEach(s=>{t[s.severity]++}),{total:e.length,by_severity:t,acknowledged:this.alerts.filter(s=>s.acknowledged).length,suppressed:this.suppressedAlerts.size,recent_history:this.alertHistory.slice(-10)}}},S=class{constructor(e={}){this.options={analysisInterval:3e4,trendAnalysisWindow:100,enableRealTimeAnalysis:!0,enableAlerts:!0,enablePrediction:!0,...e},this.trendDetector=new f,this.alertSystem=new A,this.dataStreams=new Map,this.analysisResults=new Map,this.analysisTimer=null,this.eventListeners=new Map,this.init()}init(){this.options.enableRealTimeAnalysis&&this.startRealTimeAnalysis()}registerDataStream(e,t={}){this.dataStreams.set(e,{data:[],timestamps:[],maxSize:t.maxSize||1e3,metadata:t.metadata||{},lastAnalysis:0,analysisInterval:t.analysisInterval||this.options.analysisInterval})}addDataPoint(e,t,s=null){let n=this.dataStreams.get(e);if(!n){console.warn(`Data stream ${e} not registered`);return}let r=s||Date.now();n.data.push(t),n.timestamps.push(r),n.data.length>n.maxSize&&(n.data.shift(),n.timestamps.shift()),r-n.lastAnalysis>n.analysisInterval&&this.analyzeStream(e)}addBatchData(e,t,s=null){t.forEach((n,r)=>{let i=s?s[r]:null;this.addDataPoint(e,n,i)})}analyzeStream(e){let t=this.dataStreams.get(e);if(!t||t.data.length===0)return null;let s=performance.now(),n=this.trendDetector.analyzeTrend(t.data,t.timestamps),r=this.calculateStatistics(t.data),i=this.options.enableAlerts?this.alertSystem.analyzeForAlerts(t.data,{streamId:e,...t.metadata}):[],a=this.options.enablePrediction?this.generatePrediction(t.data,t.timestamps):null,o={streamId:e,timestamp:Date.now(),dataPoints:t.data.length,timespan:t.timestamps.length>1?{start:Math.min(...t.timestamps),end:Math.max(...t.timestamps),duration:Math.max(...t.timestamps)-Math.min(...t.timestamps)}:null,trend:n,statistics:r,alerts:i,prediction:a,analysisTime:performance.now()-s};return this.analysisResults.set(e,o),t.lastAnalysis=Date.now(),this.emit("analysis_complete",{streamId:e,results:o}),i.length>0&&this.emit("alerts_generated",{streamId:e,alerts:i}),o}analyzeAllStreams(){let e={};for(let t of this.dataStreams.keys())e[t]=this.analyzeStream(t);return e}calculateStatistics(e){return e.length===0?null:{count:e.length,mean:c.mean(e),median:c.median(e),std_dev:c.standardDeviation(e),min:Math.min(...e),max:Math.max(...e),range:Math.max(...e)-Math.min(...e),percentiles:{p25:c.percentile(e,25),p50:c.percentile(e,50),p75:c.percentile(e,75),p90:c.percentile(e,90),p95:c.percentile(e,95),p99:c.percentile(e,99)},recent_stats:e.length>=10?{recent_mean:c.mean(e.slice(-10)),recent_std:c.standardDeviation(e.slice(-10))}:null}}generatePrediction(e,t=null){if(e.length<10)return null;try{let s=t?t.map(o=>new Date(o).getTime()):e.map((o,l)=>l),n=c.linearRegression(s,e);if(n.r2<.1)return{method:"linear_regression",confidence:"low",message:"Low predictive confidence due to high variance"};let r=Math.max(...s),i=s.length>1?s[s.length-1]-s[s.length-2]:1,a=[];for(let o=1;o<=5;o++){let l=r+i*o,h=n.slope*l+n.intercept;a.push({time:l,value:h,confidence:n.r2})}return{method:"linear_regression",predictions:a,confidence:n.r2>.7?"high":n.r2>.4?"medium":"low",regression_stats:n}}catch(s){return{method:"linear_regression",error:s.message,confidence:"none"}}}startRealTimeAnalysis(){this.analysisTimer||(this.analysisTimer=setInterval(()=>{let e=this.analyzeAllStreams();this.emit("realtime_analysis",{results:e,timestamp:Date.now()})},this.options.analysisInterval))}stopRealTimeAnalysis(){this.analysisTimer&&(clearInterval(this.analysisTimer),this.analysisTimer=null)}getStreamAnalysis(e){return this.analysisResults.get(e)}getAllAnalysisResults(){let e={};for(let[t,s]of this.analysisResults)e[t]=s;return e}getActiveAlerts(e=null){return this.alertSystem.getActiveAlerts(e)}acknowledgeAlert(e){return this.alertSystem.acknowledgeAlert(e)}getAlertStatistics(){return this.alertSystem.getAlertStatistics()}on(e,t){return this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(t),()=>this.off(e,t)}off(e,t){this.eventListeners.has(e)&&this.eventListeners.get(e).delete(t)}emit(e,t){this.eventListeners.has(e)&&this.eventListeners.get(e).forEach(s=>{try{s(t)}catch(n){console.error("Analytics event listener error:",n)}})}generateAnalyticsReport(){let e={timestamp:Date.now(),summary:{total_streams:this.dataStreams.size,active_alerts:this.getActiveAlerts().length,analysis_results:this.analysisResults.size},streams:{},alerts:this.getAlertStatistics(),system_health:this.getSystemHealth()};for(let[t,s]of this.dataStreams){let n=this.analysisResults.get(t);e.streams[t]={data_points:s.data.length,last_analysis:s.lastAnalysis,trend:n?n.trend.type:"unknown",alerts:n?n.alerts.length:0}}return e}getSystemHealth(){let e=Array.from(this.dataStreams.values()).filter(s=>s.data.length>0),t=Array.from(this.analysisResults.values()).filter(s=>Date.now()-s.timestamp<5*60*1e3);return{status:e.length>0?"active":"idle",active_streams:e.length,recent_analyses:t.length,avg_analysis_time:t.length>0?t.reduce((s,n)=>s+n.analysisTime,0)/t.length:0,memory_usage:this.getMemoryUsage()}}getMemoryUsage(){let e=Array.from(this.dataStreams.values()).reduce((t,s)=>t+s.data.length,0);return{total_data_points:e,estimated_memory_mb:e*16/1024/1024,streams:this.dataStreams.size,results:this.analysisResults.size}}destroy(){this.stopRealTimeAnalysis(),this.dataStreams.clear(),this.analysisResults.clear(),this.eventListeners.clear()}};typeof w<"u"&&w.exports?w.exports={AdvancedAnalyticsEngine:S,TrendDetector:f,SmartAlertSystem:A,StatisticalAnalysis:c}:(window.AdvancedAnalyticsEngine=S,window.TrendDetector=f,window.SmartAlertSystem=A,window.StatisticalAnalysis=c)});_();})();
