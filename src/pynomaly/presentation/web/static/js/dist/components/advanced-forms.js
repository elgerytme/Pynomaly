(()=>{var p=(o,t)=>()=>(t||o((t={exports:{}}).exports,t),t.exports);var c=p((f,d)=>{var a=class{constructor(t,e={}){this.container=typeof t=="string"?document.querySelector(t):t,this.options={accessibility:!0,realTimeValidation:!0,persistence:!0,submitOnEnter:!0,resetOnSubmit:!1,autoSave:!1,autoSaveInterval:3e4,...e},this.formId=this.options.id||`form-${Date.now()}`,this.validators=new Map,this.data={},this.errors={},this.touched={},this.isValid=!0,this.isSubmitting=!1,this.isDirty=!1,this.autoSaveTimer=null,this.validationDebounceTimer=null,this.init()}init(){this.setupForm(),this.setupValidation(),this.setupEventListeners(),this.setupAccessibility(),this.options.persistence&&this.loadSavedData(),this.options.autoSave&&this.startAutoSave(),window.formStore&&window.formStore.getState().createForm(this.formId,this.data)}setupForm(){this.form=this.container.querySelector("form")||this.createFormElement(),this.form.setAttribute("novalidate",""),this.form.id=this.formId}createFormElement(){let t=document.createElement("form");return this.container.appendChild(t),t}setupValidation(){this.addValidator("required",(t,e)=>!t||typeof t=="string"&&t.trim()===""?`${e.label||e.name} is required`:null),this.addValidator("email",t=>t&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?"Please enter a valid email address":null),this.addValidator("minLength",(t,e)=>t&&t.length<e.minLength?`Must be at least ${e.minLength} characters long`:null),this.addValidator("maxLength",(t,e)=>t&&t.length>e.maxLength?`Must be no more than ${e.maxLength} characters long`:null),this.addValidator("pattern",(t,e)=>t&&e.pattern&&!new RegExp(e.pattern).test(t)?e.patternMessage||"Invalid format":null),this.addValidator("number",(t,e)=>t&&isNaN(t)?"Must be a valid number":t&&e.min!==void 0&&parseFloat(t)<e.min?`Must be at least ${e.min}`:t&&e.max!==void 0&&parseFloat(t)>e.max?`Must be no more than ${e.max}`:null)}setupEventListeners(){this.form.addEventListener("submit",t=>{t.preventDefault(),this.handleSubmit()}),this.form.addEventListener("input",t=>{this.handleFieldChange(t.target)}),this.form.addEventListener("blur",t=>{this.handleFieldBlur(t.target)},!0),this.form.addEventListener("keydown",t=>{this.handleKeyDown(t)}),window.addEventListener("beforeunload",t=>{if(this.isDirty&&!this.isSubmitting)return t.preventDefault(),t.returnValue="You have unsaved changes. Are you sure you want to leave?",t.returnValue})}setupAccessibility(){if(this.options.accessibility&&(this.form.setAttribute("role","form"),this.options.ariaLabel&&this.form.setAttribute("aria-label",this.options.ariaLabel),!document.getElementById("form-announcer"))){let t=document.createElement("div");t.id="form-announcer",t.className="sr-only",t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),document.body.appendChild(t)}}addValidator(t,e){this.validators.set(t,e)}validateField(t,e){let s=this.getFieldConfig(t);if(!s)return null;let i=[];if(s.required){let r=this.validators.get("required")(e,s);r&&i.push(r)}if(s.type==="email"){let r=this.validators.get("email")(e,s);r&&i.push(r)}if(s.type==="number"){let r=this.validators.get("number")(e,s);r&&i.push(r)}if(s.minLength){let r=this.validators.get("minLength")(e,s);r&&i.push(r)}if(s.maxLength){let r=this.validators.get("maxLength")(e,s);r&&i.push(r)}if(s.pattern){let r=this.validators.get("pattern")(e,s);r&&i.push(r)}if(s.validator&&typeof s.validator=="function"){let r=s.validator(e,s,this.data);r&&i.push(r)}return i.length>0?i[0]:null}validateForm(){let t={},e=!0;return Object.keys(this.data).forEach(s=>{let i=this.validateField(s,this.data[s]);i&&(t[s]=i,e=!1)}),this.errors=t,this.isValid=e,e}handleFieldChange(t){let e=t.name,s=this.getFieldValue(t);this.data[e]=s,this.isDirty=!0,this.options.realTimeValidation&&(clearTimeout(this.validationDebounceTimer),this.validationDebounceTimer=setTimeout(()=>{this.validateAndUpdateField(e)},300)),window.formStore&&window.formStore.getState().updateFormField(this.formId,e,s),this.options.autoSave&&this.saveData(),this.emit("fieldChange",{field:e,value:s,data:this.data})}handleFieldBlur(t){let e=t.name;this.touched[e]=!0,this.options.realTimeValidation||this.validateAndUpdateField(e),this.emit("fieldBlur",{field:e,data:this.data})}validateAndUpdateField(t){let e=this.validateField(t,this.data[t]);e?this.errors[t]=e:delete this.errors[t],this.updateFieldErrorDisplay(t,e),this.isValid=Object.keys(this.errors).length===0}updateFieldErrorDisplay(t,e){let s=this.form.querySelector(`[name="${t}"]`);if(!s)return;let i=document.getElementById(`${t}-error`);e?(s.setAttribute("aria-invalid","true"),s.classList.add("error"),i?(i.textContent=e,i.style.display="block"):this.createErrorElement(s,t,e)):(s.setAttribute("aria-invalid","false"),s.classList.remove("error"),i&&(i.style.display="none"))}createErrorElement(t,e,s){let i=document.createElement("div");i.id=`${e}-error`,i.className="field-error",i.textContent=s,i.setAttribute("role","alert"),i.setAttribute("aria-live","polite"),t.setAttribute("aria-describedby",i.id),t.parentNode.insertBefore(i,t.nextSibling)}getFieldValue(t){switch(t.type){case"checkbox":return t.checked;case"radio":return t.checked?t.value:null;case"file":return t.files;case"number":return t.value?parseFloat(t.value):null;default:return t.value}}getFieldConfig(t){return null}handleKeyDown(t){t.key==="Enter"&&this.options.submitOnEnter&&t.target.tagName!=="TEXTAREA"&&(t.preventDefault(),this.handleSubmit())}async handleSubmit(){if(!this.isSubmitting){if(this.isSubmitting=!0,this.emit("beforeSubmit",{data:this.data}),!this.validateForm()){this.isSubmitting=!1,this.focusFirstError(),this.announceErrors(),this.emit("validationFailed",{errors:this.errors});return}try{let t=await this.submit(this.data);this.options.resetOnSubmit?this.reset():this.isDirty=!1,this.options.persistence&&this.clearSavedData(),this.announceSuccess(),this.emit("submitSuccess",{data:this.data,result:t})}catch(t){console.error("Form submission error:",t),this.emit("submitError",{error:t,data:this.data}),this.announceError("Form submission failed. Please try again.")}finally{this.isSubmitting=!1}}}async submit(t){throw new Error("submit() method must be implemented by subclass")}reset(){this.form.reset(),this.data={},this.errors={},this.touched={},this.isDirty=!1,this.isValid=!0,this.form.querySelectorAll(".field-error").forEach(t=>{t.style.display="none"}),this.form.querySelectorAll('[aria-invalid="true"]').forEach(t=>{t.setAttribute("aria-invalid","false"),t.classList.remove("error")}),this.emit("reset")}focusFirstError(){let t=Object.keys(this.errors)[0];if(t){let e=this.form.querySelector(`[name="${t}"]`);e&&e.focus()}}announceErrors(){let t=Object.keys(this.errors).length,e=`Form has ${t} error${t!==1?"s":""}. Please correct the highlighted fields.`;this.announce(e)}announceSuccess(){this.announce("Form submitted successfully")}announceError(t){this.announce(t)}announce(t){let e=document.getElementById("form-announcer");e&&(e.textContent=t)}saveData(){if(this.options.persistence)try{let t={data:this.data,timestamp:Date.now()};localStorage.setItem(`form-${this.formId}`,JSON.stringify(t))}catch(t){console.warn("Failed to save form data:",t)}}loadSavedData(){if(this.options.persistence)try{let t=localStorage.getItem(`form-${this.formId}`);if(t){let{data:e,timestamp:s}=JSON.parse(t);Date.now()-s<24*60*60*1e3&&(this.data=e,this.populateForm())}}catch(t){console.warn("Failed to load saved form data:",t)}}clearSavedData(){if(this.options.persistence)try{localStorage.removeItem(`form-${this.formId}`)}catch(t){console.warn("Failed to clear saved form data:",t)}}populateForm(){Object.entries(this.data).forEach(([t,e])=>{let s=this.form.querySelector(`[name="${t}"]`);s&&(s.type==="checkbox"?s.checked=!!e:s.type==="radio"?s.value===e&&(s.checked=!0):s.value=e||"")})}startAutoSave(){this.autoSaveTimer=setInterval(()=>{this.isDirty&&this.saveData()},this.options.autoSaveInterval)}stopAutoSave(){this.autoSaveTimer&&(clearInterval(this.autoSaveTimer),this.autoSaveTimer=null)}emit(t,e){let s=new CustomEvent(`form:${t}`,{detail:{form:this,...e}});this.container.dispatchEvent(s)}destroy(){this.stopAutoSave(),this.validationDebounceTimer&&clearTimeout(this.validationDebounceTimer),window.formStore&&window.formStore.getState().removeForm(this.formId)}},h=class extends a{constructor(t,e={}){super(t,{showProgress:!0,allowStepSkipping:!1,validateOnStepChange:!0,persistCurrentStep:!0,...e}),this.steps=this.options.steps||[],this.currentStep=0,this.stepData={},this.stepValidations=new Map,this.initMultiStep()}initMultiStep(){this.createStepContainer(),this.createProgressIndicator(),this.createNavigationButtons(),this.loadCurrentStep(),this.showStep(this.currentStep)}createStepContainer(){this.stepContainer=document.createElement("div"),this.stepContainer.className="step-container",this.form.appendChild(this.stepContainer)}createProgressIndicator(){this.options.showProgress&&(this.progressContainer=document.createElement("div"),this.progressContainer.className="step-progress",this.progressContainer.setAttribute("role","progressbar"),this.progressContainer.setAttribute("aria-label","Form progress"),this.progressContainer.setAttribute("aria-valuemin","0"),this.progressContainer.setAttribute("aria-valuemax",this.steps.length.toString()),this.form.insertBefore(this.progressContainer,this.stepContainer),this.createProgressSteps())}createProgressSteps(){let t=document.createElement("ol");t.className="progress-steps",this.steps.forEach((e,s)=>{let i=document.createElement("li");i.className="progress-step",i.setAttribute("data-step",s.toString());let r=document.createElement("button");r.type="button",r.className="progress-step-button",r.setAttribute("aria-label",`Step ${s+1}: ${e.title}`),r.textContent=(s+1).toString(),this.options.allowStepSkipping?r.addEventListener("click",()=>this.goToStep(s)):r.disabled=s>this.currentStep;let n=document.createElement("span");n.className="progress-step-title",n.textContent=e.title,i.appendChild(r),i.appendChild(n),t.appendChild(i)}),this.progressContainer.appendChild(t)}createNavigationButtons(){this.navigationContainer=document.createElement("div"),this.navigationContainer.className="step-navigation",this.prevButton=document.createElement("button"),this.prevButton.type="button",this.prevButton.className="btn btn-secondary step-prev",this.prevButton.textContent="Previous",this.prevButton.addEventListener("click",()=>this.previousStep()),this.nextButton=document.createElement("button"),this.nextButton.type="button",this.nextButton.className="btn btn-primary step-next",this.nextButton.textContent="Next",this.nextButton.addEventListener("click",()=>this.nextStep()),this.submitButton=document.createElement("button"),this.submitButton.type="submit",this.submitButton.className="btn btn-primary step-submit",this.submitButton.textContent="Submit",this.navigationContainer.appendChild(this.prevButton),this.navigationContainer.appendChild(this.nextButton),this.navigationContainer.appendChild(this.submitButton),this.form.appendChild(this.navigationContainer)}showStep(t){if(t<0||t>=this.steps.length)return;this.stepContainer.querySelectorAll(".form-step").forEach(s=>{s.style.display="none",s.setAttribute("aria-hidden","true")});let e=this.stepContainer.querySelector(`[data-step="${t}"]`);if(e){e.style.display="block",e.setAttribute("aria-hidden","false");let s=e.querySelector("input, select, textarea");s&&s.focus()}else this.createStepElement(t);this.updateProgress(),this.updateNavigation(),this.announceStepChange()}createStepElement(t){let e=this.steps[t],s=document.createElement("div");s.className="form-step",s.setAttribute("data-step",t.toString()),s.setAttribute("role","tabpanel"),s.setAttribute("aria-labelledby",`step-${t}-title`);let i=document.createElement("h2");if(i.id=`step-${t}-title`,i.className="step-title",i.textContent=e.title,s.appendChild(i),e.description){let r=document.createElement("p");r.className="step-description",r.textContent=e.description,s.appendChild(r)}if(e.fields){let r=document.createElement("div");r.className="step-fields",e.fields.forEach(n=>{let l=this.createFieldElement(n);r.appendChild(l)}),s.appendChild(r)}this.stepContainer.appendChild(s)}createFieldElement(t){let e=document.createElement("div");e.className="form-group";let s=document.createElement("label");s.setAttribute("for",t.name),s.className="form-label",s.textContent=t.label,t.required&&(s.innerHTML+=' <span class="required" aria-label="required">*</span>'),e.appendChild(s);let i;switch(t.type){case"textarea":i=document.createElement("textarea");break;case"select":i=document.createElement("select"),t.options?.forEach(r=>{let n=document.createElement("option");n.value=r.value,n.textContent=r.label,i.appendChild(n)});break;default:i=document.createElement("input"),i.type=t.type||"text"}if(i.id=t.name,i.name=t.name,i.className="form-input",t.placeholder&&(i.placeholder=t.placeholder),t.required&&i.setAttribute("aria-required","true"),e.appendChild(i),t.help){let r=document.createElement("div");r.className="form-help",r.id=`${t.name}-help`,r.textContent=t.help,i.setAttribute("aria-describedby",r.id),e.appendChild(r)}return e}updateProgress(){if(!this.options.showProgress)return;let t=((this.currentStep+1)/this.steps.length*100).toFixed(0);this.progressContainer.setAttribute("aria-valuenow",(this.currentStep+1).toString()),this.progressContainer.setAttribute("aria-valuetext",`Step ${this.currentStep+1} of ${this.steps.length}`),this.progressContainer.querySelectorAll(".progress-step").forEach((e,s)=>{e.classList.remove("current","completed"),s<this.currentStep?e.classList.add("completed"):s===this.currentStep&&e.classList.add("current")})}updateNavigation(){this.prevButton.style.display=this.currentStep>0?"inline-block":"none",this.nextButton.style.display=this.currentStep<this.steps.length-1?"inline-block":"none",this.submitButton.style.display=this.currentStep===this.steps.length-1?"inline-block":"none",this.prevButton.disabled=this.isSubmitting,this.nextButton.disabled=this.isSubmitting,this.submitButton.disabled=this.isSubmitting}announceStepChange(){let t=this.steps[this.currentStep],e=`Now on step ${this.currentStep+1} of ${this.steps.length}: ${t.title}`;this.announce(e)}validateCurrentStep(){let t=this.steps[this.currentStep];if(!t.fields)return!0;let e=!0,s={};return t.fields.forEach(i=>{let r=this.data[i.name],n=this.validateField(i.name,r);n&&(s[i.name]=n,e=!1)}),e||(this.errors={...this.errors,...s},this.focusFirstError()),e}nextStep(){this.options.validateOnStepChange&&!this.validateCurrentStep()||this.currentStep<this.steps.length-1&&(this.currentStep++,this.showStep(this.currentStep),this.options.persistCurrentStep&&this.saveCurrentStep())}previousStep(){this.currentStep>0&&(this.currentStep--,this.showStep(this.currentStep),this.options.persistCurrentStep&&this.saveCurrentStep())}goToStep(t){this.options.allowStepSkipping&&t>=0&&t<this.steps.length&&(this.currentStep=t,this.showStep(this.currentStep))}saveCurrentStep(){try{localStorage.setItem(`form-step-${this.formId}`,this.currentStep.toString())}catch(t){console.warn("Failed to save current step:",t)}}loadCurrentStep(){try{let t=localStorage.getItem(`form-step-${this.formId}`);t&&(this.currentStep=parseInt(t,10),this.currentStep>=this.steps.length&&(this.currentStep=0))}catch(t){console.warn("Failed to load current step:",t)}}getFieldConfig(t){for(let e of this.steps)if(e.fields){let s=e.fields.find(i=>i.name===t);if(s)return s}return null}async submit(t){let e=!0;for(let s=0;s<this.steps.length;s++){let i=this.steps[s];i.fields&&i.fields.forEach(r=>{let n=this.validateField(r.name,t[r.name]);n&&(this.errors[r.name]=n,e=!1)})}if(!e)throw new Error("Form validation failed");return this.options.onSubmit?await this.options.onSubmit(t):{success:!0,data:t}}reset(){super.reset(),this.currentStep=0,this.stepData={},this.showStep(0),this.options.persistCurrentStep&&localStorage.removeItem(`form-step-${this.formId}`)}},u=class extends a{constructor(t,e={}){super(t,{multiple:!1,maxFiles:10,maxFileSize:10*1024*1024,acceptedTypes:["*/*"],dragDrop:!0,showProgress:!0,showPreview:!0,chunkSize:1024*1024,...e}),this.files=[],this.uploads=new Map,this.initFileUpload()}initFileUpload(){this.createUploadArea(),this.createFileList(),this.createProgressArea(),this.setupFileValidation()}createUploadArea(){this.uploadArea=document.createElement("div"),this.uploadArea.className="file-upload-area",this.uploadArea.setAttribute("role","button"),this.uploadArea.setAttribute("tabindex","0"),this.uploadArea.setAttribute("aria-label","Click or drag files to upload");let t=document.createElement("div");t.className="upload-content",t.innerHTML=`
      <div class="upload-icon">\u{1F4C1}</div>
      <div class="upload-text">
        <p>Click to select files or drag and drop</p>
        <p class="upload-help">
          ${this.options.acceptedTypes.join(", ")} \u2022 
          Max ${this.formatFileSize(this.options.maxFileSize)}
        </p>
      </div>
    `,this.fileInput=document.createElement("input"),this.fileInput.type="file",this.fileInput.name="files",this.fileInput.className="file-input",this.fileInput.style.display="none",this.options.multiple&&(this.fileInput.multiple=!0),this.options.acceptedTypes.length>0&&!this.options.acceptedTypes.includes("*/*")&&(this.fileInput.accept=this.options.acceptedTypes.join(",")),this.uploadArea.appendChild(t),this.uploadArea.appendChild(this.fileInput),this.form.appendChild(this.uploadArea),this.setupUploadAreaEvents()}setupUploadAreaEvents(){this.uploadArea.addEventListener("click",()=>{this.fileInput.click()}),this.uploadArea.addEventListener("keydown",t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),this.fileInput.click())}),this.fileInput.addEventListener("change",t=>{this.handleFileSelection(t.target.files)}),this.options.dragDrop&&this.setupDragDrop()}setupDragDrop(){["dragenter","dragover","dragleave","drop"].forEach(t=>{this.uploadArea.addEventListener(t,e=>{e.preventDefault(),e.stopPropagation()})}),["dragenter","dragover"].forEach(t=>{this.uploadArea.addEventListener(t,()=>{this.uploadArea.classList.add("drag-over")})}),["dragleave","drop"].forEach(t=>{this.uploadArea.addEventListener(t,()=>{this.uploadArea.classList.remove("drag-over")})}),this.uploadArea.addEventListener("drop",t=>{let e=t.dataTransfer.files;this.handleFileSelection(e)})}createFileList(){this.fileListContainer=document.createElement("div"),this.fileListContainer.className="file-list",this.fileListContainer.setAttribute("role","list"),this.fileListContainer.setAttribute("aria-label","Selected files"),this.form.appendChild(this.fileListContainer)}createProgressArea(){this.options.showProgress&&(this.progressArea=document.createElement("div"),this.progressArea.className="upload-progress-area",this.progressArea.style.display="none",this.form.appendChild(this.progressArea))}setupFileValidation(){this.addValidator("fileType",t=>this.options.acceptedTypes.includes("*/*")||this.options.acceptedTypes.some(s=>s.endsWith("/*")?t.type.startsWith(s.slice(0,-1)):t.type===s||t.name.toLowerCase().endsWith(s.toLowerCase()))?null:`File type not supported. Accepted types: ${this.options.acceptedTypes.join(", ")}`),this.addValidator("fileSize",t=>t.size>this.options.maxFileSize?`File size exceeds limit of ${this.formatFileSize(this.options.maxFileSize)}`:null)}handleFileSelection(t){let e=Array.from(t);if(!this.options.multiple&&e.length>1){this.announce("Only one file can be selected");return}if(this.files.length+e.length>this.options.maxFiles){this.announce(`Maximum ${this.options.maxFiles} files allowed`);return}let s=[],i=[];if(e.forEach(r=>{let n=this.validators.get("fileType")(r),l=this.validators.get("fileSize")(r);n||l?i.push(`${r.name}: ${n||l}`):s.push(r)}),i.length>0){this.announce(`File validation errors: ${i.join("; ")}`);return}s.forEach(r=>{let n={id:Date.now()+Math.random(),file:r,name:r.name,size:r.size,type:r.type,status:"selected",progress:0,error:null};this.files.push(n),this.createFileItem(n)}),this.updateFileList(),this.emit("filesSelected",{files:s})}createFileItem(t){let e=document.createElement("div");e.className="file-item",e.setAttribute("data-file-id",t.id),e.setAttribute("role","listitem"),e.innerHTML=`
      <div class="file-icon">${this.getFileIcon(t.type)}</div>
      <div class="file-info">
        <div class="file-name">${t.name}</div>
        <div class="file-size">${this.formatFileSize(t.size)}</div>
        <div class="file-status">${t.status}</div>
      </div>
      <div class="file-progress">
        <div class="progress-bar">
          <div class="progress-fill" style="width: ${t.progress}%"></div>
        </div>
        <div class="progress-text">${t.progress}%</div>
      </div>
      <div class="file-actions">
        <button type="button" class="btn-remove" aria-label="Remove ${t.name}">\u2715</button>
      </div>
    `,e.querySelector(".btn-remove").addEventListener("click",()=>{this.removeFile(t.id)}),this.fileListContainer.appendChild(e)}updateFileItem(t){let e=this.fileListContainer.querySelector(`[data-file-id="${t.id}"]`);if(!e)return;let s=e.querySelector(".file-status"),i=e.querySelector(".progress-fill"),r=e.querySelector(".progress-text");s&&(s.textContent=t.status),i&&(i.style.width=`${t.progress}%`),r&&(r.textContent=`${t.progress}%`),e.setAttribute("aria-label",`${t.name}, ${t.status}, ${t.progress}% complete`)}removeFile(t){let e=this.files.findIndex(r=>r.id===t);if(e===-1)return;let s=this.files[e];if(this.uploads.has(t)){let r=this.uploads.get(t);r.xhr&&r.xhr.abort(),this.uploads.delete(t)}this.files.splice(e,1);let i=this.fileListContainer.querySelector(`[data-file-id="${t}"]`);i&&i.remove(),this.updateFileList(),this.emit("fileRemoved",{file:s})}updateFileList(){this.fileListContainer.style.display=this.files.length>0?"block":"none",this.files.length>=this.options.maxFiles?(this.uploadArea.classList.add("disabled"),this.uploadArea.setAttribute("aria-disabled","true")):(this.uploadArea.classList.remove("disabled"),this.uploadArea.setAttribute("aria-disabled","false"))}async startUpload(){if(this.files.length===0){this.announce("No files selected for upload");return}let t=this.files.filter(e=>e.status==="selected");if(t.length===0){this.announce("No files ready for upload");return}this.isSubmitting=!0,this.emit("uploadStart",{files:t});try{let e=t.map(n=>this.uploadFile(n)),s=await Promise.allSettled(e),i=s.filter(n=>n.status==="fulfilled").length,r=s.filter(n=>n.status==="rejected").length;this.announce(`Upload complete. ${i} successful, ${r} failed.`),this.emit("uploadComplete",{successful:i,failed:r,results:s})}catch(e){console.error("Upload error:",e),this.announce("Upload failed"),this.emit("uploadError",{error:e})}finally{this.isSubmitting=!1}}async uploadFile(t){return t.status="uploading",t.progress=0,this.updateFileItem(t),new Promise((e,s)=>{let i=new XMLHttpRequest,r=new FormData;r.append("file",t.file),this.uploads.set(t.id,{xhr:i,fileData:t}),i.upload.addEventListener("progress",n=>{n.lengthComputable&&(t.progress=Math.round(n.loaded/n.total*100),this.updateFileItem(t))}),i.addEventListener("load",()=>{i.status>=200&&i.status<300?(t.status="completed",t.progress=100,this.updateFileItem(t),this.uploads.delete(t.id),e(JSON.parse(i.responseText))):(t.status="error",t.error=`Upload failed: ${i.statusText}`,this.updateFileItem(t),this.uploads.delete(t.id),s(new Error(t.error)))}),i.addEventListener("error",()=>{t.status="error",t.error="Upload failed",this.updateFileItem(t),this.uploads.delete(t.id),s(new Error("Upload failed"))}),i.addEventListener("abort",()=>{t.status="cancelled",this.updateFileItem(t),this.uploads.delete(t.id),s(new Error("Upload cancelled"))}),i.open("POST",this.options.uploadUrl||"/api/upload"),i.send(r)})}getFileIcon(t){return t.startsWith("image/")?"\u{1F5BC}\uFE0F":t.startsWith("video/")?"\u{1F3A5}":t.startsWith("audio/")?"\u{1F3B5}":t.includes("pdf")?"\u{1F4C4}":t.includes("word")?"\u{1F4DD}":t.includes("excel")||t.includes("spreadsheet")?"\u{1F4CA}":t.includes("zip")||t.includes("compressed")?"\u{1F4E6}":"\u{1F4C1}"}formatFileSize(t){if(t===0)return"0 Bytes";let e=1024,s=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,i)).toFixed(2))+" "+s[i]}async submit(t){return await this.startUpload(),{files:this.files}}reset(){super.reset(),this.uploads.forEach(t=>{t.xhr&&t.xhr.abort()}),this.uploads.clear(),this.files=[],this.fileListContainer.innerHTML="",this.updateFileList()}};typeof d<"u"&&d.exports?d.exports={BaseForm:a,MultiStepForm:h,FileUploadForm:u}:(window.BaseForm=a,window.MultiStepForm=h,window.FileUploadForm=u)});c();})();
