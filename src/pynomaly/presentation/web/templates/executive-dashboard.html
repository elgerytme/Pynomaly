<!doctype html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Pynomaly - Executive Dashboard" />
    <title>Executive Dashboard - Pynomaly</title>

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#0ea5e9" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Pynomaly" />

    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="/static/icons/icon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/static/icons/icon-16x16.png" />
    <link rel="apple-touch-icon" href="/static/icons/icon-192x192.png" />
    <link rel="manifest" href="/static/manifest.json" />

    <!-- Stylesheets -->
    <link href="/static/css/output.css" rel="stylesheet" />
    <link href="/static/css/design-system.css" rel="stylesheet" />
    <link href="/static/css/tailwind.css" rel="stylesheet" />
    <link href="/static/css/accessibility.css" rel="stylesheet" />

    <!-- Preload Critical Resources -->
    <link rel="preload" href="/static/js/components/executive-dashboard.js" as="script" />
    <link rel="preload" href="https://d3js.org/d3.v7.min.js" as="script" />
</head>
<body class="h-full bg-neutral-50 dark:bg-neutral-900" x-data="executiveDashboard()">
    <!-- Skip Links for Accessibility -->
    <div class="skip-links">
        <a href="#main-content" class="skip-link">Skip to main content</a>
        <a href="#navigation" class="skip-link">Skip to navigation</a>
        <a href="#kpi-overview" class="skip-link">Skip to KPI overview</a>
        <a href="#strategic-insights" class="skip-link">Skip to strategic insights</a>
    </div>

    <!-- App Container -->
    <div id="app" class="h-full flex">
        <!-- Sidebar Navigation -->
        <aside id="navigation" class="sidebar" aria-label="Main navigation" x-show="sidebarOpen" x-transition>
            <div class="sidebar-header">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-primary-500 rounded-lg flex items-center justify-center">
                            <span class="text-white font-bold text-sm">P</span>
                        </div>
                        <span class="font-semibold text-lg text-neutral-900 dark:text-white">Pynomaly</span>
                    </div>
                    <button @click="sidebarOpen = false" class="lg:hidden">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <nav class="sidebar-nav" aria-label="Primary navigation">
                <a href="/" class="nav-link nav-link-inactive">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Home</span>
                </a>
                <a href="/data-science-dashboard" class="nav-link nav-link-inactive">
                    <span class="nav-icon">üî¨</span>
                    <span class="nav-text">Data Science</span>
                </a>
                <a href="/ml-pipeline-designer" class="nav-link nav-link-inactive">
                    <span class="nav-icon">üîß</span>
                    <span class="nav-text">ML Pipeline</span>
                </a>
                <a href="/executive-dashboard" class="nav-link nav-link-active" aria-current="page">
                    <span class="nav-icon">üëî</span>
                    <span class="nav-text">Executive</span>
                </a>
            </nav>

            <div class="sidebar-footer mt-auto p-4">
                <button class="btn btn-ghost btn-sm w-full" @click="toggleTheme()" aria-label="Toggle dark mode">
                    <span x-text="darkMode ? '‚òÄÔ∏è' : 'üåô'"></span>
                    <span x-text="darkMode ? 'Light Mode' : 'Dark Mode'"></span>
                </button>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main id="main-content" class="main-content flex-1" :class="{'main-content-with-sidebar': sidebarOpen}">
            <!-- Mobile Header -->
            <div class="lg:hidden bg-white dark:bg-neutral-800 border-b border-neutral-200 dark:border-neutral-700 p-4">
                <div class="flex items-center justify-between">
                    <button @click="sidebarOpen = true" class="btn btn-ghost btn-sm">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                    <h1 class="text-lg font-semibold">Executive Dashboard</h1>
                    <div class="w-10"></div>
                </div>
            </div>

            <!-- Page Header -->
            <header class="page-header">
                <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between">
                    <div>
                        <h1 class="page-title">üëî Executive Dashboard</h1>
                        <p class="page-subtitle">Strategic insights for quality and analytics performance</p>
                    </div>

                    <div class="header-actions flex items-center space-x-3 mt-4 lg:mt-0">
                        <select x-model="timeRange" @change="refreshData()" class="form-select form-select-sm">
                            <option value="7d">Last 7 Days</option>
                            <option value="30d" selected>Last 30 Days</option>
                            <option value="90d">Last 90 Days</option>
                            <option value="1y">Last Year</option>
                        </select>
                        <button @click="exportReport()" class="btn btn-outline btn-sm">
                            <span>üìä</span>
                            <span class="hidden sm:inline">Export Report</span>
                        </button>
                        <button @click="refreshData()" class="btn btn-primary btn-sm" :disabled="loading">
                            <span :class="loading ? 'animate-spin' : ''">üîÑ</span>
                            <span class="hidden sm:inline">Refresh</span>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Executive Dashboard Content -->
            <div class="dashboard-content p-6 space-y-6">
                <!-- Executive KPI Overview -->
                <section id="kpi-overview" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="metric-card" x-data="{ value: 0 }" x-init="animateNumber('value', executiveKPIs.dataQualityScore, 1500)">
                        <div class="card-content">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="metric-value text-primary-600" x-text="`${value.toFixed(1)}%`"></div>
                                    <div class="metric-label">Data Quality Score</div>
                                </div>
                                <div class="metric-icon bg-primary-100 text-primary-600">üéØ</div>
                            </div>
                            <div class="metric-change" :class="executiveKPIs.dataQualityTrend >= 0 ? 'metric-change-positive' : 'metric-change-negative'" 
                                 x-text="`${executiveKPIs.dataQualityTrend >= 0 ? '+' : ''}${executiveKPIs.dataQualityTrend.toFixed(1)}% this period`"></div>
                        </div>
                    </div>

                    <div class="metric-card" x-data="{ value: 0 }" x-init="animateNumber('value', executiveKPIs.anomalyDetectionRate, 1200)">
                        <div class="card-content">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="metric-value text-secondary-600" x-text="`${value.toFixed(2)}%`"></div>
                                    <div class="metric-label">Anomaly Detection Rate</div>
                                </div>
                                <div class="metric-icon bg-secondary-100 text-secondary-600">üîç</div>
                            </div>
                            <div class="metric-change metric-change-neutral">Within expected range</div>
                        </div>
                    </div>

                    <div class="metric-card" x-data="{ value: 0 }" x-init="animateNumber('value', executiveKPIs.operationalEfficiency, 1800)">
                        <div class="card-content">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="metric-value text-accent-600" x-text="`${value.toFixed(1)}%`"></div>
                                    <div class="metric-label">Operational Efficiency</div>
                                </div>
                                <div class="metric-icon bg-accent-100 text-accent-600">‚ö°</div>
                            </div>
                            <div class="metric-change" :class="executiveKPIs.efficiencyTrend >= 0 ? 'metric-change-positive' : 'metric-change-negative'" 
                                 x-text="`${executiveKPIs.efficiencyTrend >= 0 ? '+' : ''}${executiveKPIs.efficiencyTrend.toFixed(1)}% improvement`"></div>
                        </div>
                    </div>

                    <div class="metric-card" x-data="{ value: 0 }" x-init="animateNumber('value', executiveKPIs.costSavings, 2000)">
                        <div class="card-content">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="metric-value text-success-600" x-text="`$${(value/1000).toFixed(0)}K`"></div>
                                    <div class="metric-label">Cost Savings</div>
                                </div>
                                <div class="metric-icon bg-success-100 text-success-600">üí∞</div>
                            </div>
                            <div class="metric-change metric-change-positive" x-text="`${executiveKPIs.savingsTrend.toFixed(1)}% vs target`"></div>
                        </div>
                    </div>
                </section>

                <!-- Strategic Insights Section -->
                <section id="strategic-insights" class="grid grid-cols-1 xl:grid-cols-3 gap-6">
                    <!-- Quality Trend Analysis -->
                    <div class="xl:col-span-2 card">
                        <div class="card-header">
                            <h2 class="text-xl font-semibold flex items-center">
                                <span class="mr-2">üìà</span>
                                Quality & Performance Trends
                            </h2>
                            <div class="flex items-center space-x-2">
                                <select x-model="trendMetric" @change="updateTrendChart()" class="form-select form-select-sm">
                                    <option value="quality">Data Quality</option>
                                    <option value="performance">Performance</option>
                                    <option value="efficiency">Efficiency</option>
                                    <option value="savings">Cost Savings</option>
                                </select>
                            </div>
                        </div>
                        <div class="card-content">
                            <div id="trend-chart" class="h-80"></div>
                        </div>
                    </div>

                    <!-- Key Metrics Summary -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="text-xl font-semibold flex items-center">
                                <span class="mr-2">üìã</span>
                                Key Metrics Summary
                            </h2>
                        </div>
                        <div class="card-content">
                            <div class="space-y-4">
                                <template x-for="metric in keyMetricsSummary" :key="metric.name">
                                    <div class="p-3 rounded-lg border border-neutral-200 dark:border-neutral-700">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-sm font-medium" x-text="metric.name"></span>
                                            <span class="text-sm" :class="{
                                                'text-green-600': metric.status === 'good',
                                                'text-yellow-600': metric.status === 'warning',
                                                'text-red-600': metric.status === 'critical'
                                            }" x-text="metric.value"></span>
                                        </div>
                                        <div class="w-full bg-neutral-200 dark:bg-neutral-700 rounded-full h-2">
                                            <div class="h-2 rounded-full" :class="{
                                                'bg-green-500': metric.status === 'good',
                                                'bg-yellow-500': metric.status === 'warning',
                                                'bg-red-500': metric.status === 'critical'
                                            }" :style="`width: ${metric.percentage}%`"></div>
                                        </div>
                                        <div class="text-xs text-neutral-500 mt-1" x-text="metric.description"></div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Business Impact Analysis -->
                <section class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- ROI Analysis -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="text-xl font-semibold flex items-center">
                                <span class="mr-2">üíé</span>
                                ROI Analysis
                            </h2>
                            <button @click="viewDetailedROI()" class="btn btn-outline btn-sm">
                                <span>üìä</span>
                                Details
                            </button>
                        </div>
                        <div class="card-content">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                <div class="text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg">
                                    <div class="text-2xl font-bold text-green-600" x-text="`${roiAnalysis.totalROI}%`"></div>
                                    <div class="text-sm text-green-600">Total ROI</div>
                                </div>
                                <div class="text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                    <div class="text-2xl font-bold text-blue-600" x-text="`${roiAnalysis.paybackPeriod} months`"></div>
                                    <div class="text-sm text-blue-600">Payback Period</div>
                                </div>
                            </div>
                            <div id="roi-chart" class="h-48"></div>
                        </div>
                    </div>

                    <!-- Risk Assessment -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="text-xl font-semibold flex items-center">
                                <span class="mr-2">‚ö†Ô∏è</span>
                                Risk Assessment
                            </h2>
                        </div>
                        <div class="card-content">
                            <div class="space-y-4">
                                <template x-for="risk in riskAssessment" :key="risk.id">
                                    <div class="p-4 rounded-lg border" :class="{
                                        'border-red-200 bg-red-50 dark:bg-red-900/20': risk.level === 'high',
                                        'border-yellow-200 bg-yellow-50 dark:bg-yellow-900/20': risk.level === 'medium',
                                        'border-green-200 bg-green-50 dark:bg-green-900/20': risk.level === 'low'
                                    }">
                                        <div class="flex items-start justify-between">
                                            <div class="flex-1">
                                                <div class="font-medium" x-text="risk.title"></div>
                                                <div class="text-sm text-neutral-600 dark:text-neutral-400 mt-1" x-text="risk.description"></div>
                                                <div class="text-xs mt-2" :class="{
                                                    'text-red-600': risk.level === 'high',
                                                    'text-yellow-600': risk.level === 'medium',
                                                    'text-green-600': risk.level === 'low'
                                                }" x-text="`${risk.level.toUpperCase()} RISK - Impact: ${risk.impact}`"></div>
                                            </div>
                                            <div class="ml-3">
                                                <span class="text-lg" x-text="risk.icon"></span>
                                            </div>
                                        </div>
                                        <div class="mt-3">
                                            <button @click="viewRiskDetails(risk.id)" class="text-xs text-primary-600 hover:text-primary-700">
                                                View Mitigation Plan ‚Üí
                                            </button>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Operational Excellence Dashboard -->
                <section class="card">
                    <div class="card-header">
                        <h2 class="text-xl font-semibold flex items-center">
                            <span class="mr-2">üéñÔ∏è</span>
                            Operational Excellence Dashboard
                        </h2>
                        <div class="flex items-center space-x-2">
                            <button @click="viewComplianceReport()" class="btn btn-outline btn-sm">
                                <span>üìã</span>
                                Compliance
                            </button>
                            <button @click="scheduleBoardMeeting()" class="btn btn-primary btn-sm">
                                <span>üìÖ</span>
                                Schedule Review
                            </button>
                        </div>
                    </div>
                    <div class="card-content">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <!-- Process Efficiency -->
                            <div class="text-center">
                                <div class="relative w-32 h-32 mx-auto mb-4">
                                    <div id="efficiency-gauge" class="w-full h-full"></div>
                                </div>
                                <div class="font-medium">Process Efficiency</div>
                                <div class="text-sm text-neutral-500">Target: 95%</div>
                            </div>

                            <!-- Data Governance Score -->
                            <div class="text-center">
                                <div class="relative w-32 h-32 mx-auto mb-4">
                                    <div id="governance-gauge" class="w-full h-full"></div>
                                </div>
                                <div class="font-medium">Data Governance</div>
                                <div class="text-sm text-neutral-500">Compliance Score</div>
                            </div>

                            <!-- Innovation Index -->
                            <div class="text-center">
                                <div class="relative w-32 h-32 mx-auto mb-4">
                                    <div id="innovation-gauge" class="w-full h-full"></div>
                                </div>
                                <div class="font-medium">Innovation Index</div>
                                <div class="text-sm text-neutral-500">Industry Benchmark</div>
                            </div>
                        </div>

                        <!-- Strategic Action Items -->
                        <div class="mt-8">
                            <h3 class="font-medium mb-4">Strategic Action Items</h3>
                            <div class="space-y-3">
                                <template x-for="action in strategicActions" :key="action.id">
                                    <div class="flex items-center justify-between p-3 bg-neutral-50 dark:bg-neutral-800 rounded-lg">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-3 h-3 rounded-full" :class="{
                                                'bg-red-500': action.priority === 'high',
                                                'bg-yellow-500': action.priority === 'medium',
                                                'bg-green-500': action.priority === 'low'
                                            }"></div>
                                            <div>
                                                <div class="font-medium" x-text="action.title"></div>
                                                <div class="text-sm text-neutral-500" x-text="action.description"></div>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <span class="text-sm text-neutral-500" x-text="action.dueDate"></span>
                                            <button @click="viewActionDetails(action.id)" class="btn btn-ghost btn-xs">
                                                View
                                            </button>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Notifications Container -->
    <div id="notifications" class="fixed top-4 right-4 z-toast space-y-2" aria-live="polite"></div>

    <!-- Live Region for Screen Readers -->
    <div id="live-region" class="sr-only" aria-live="polite" aria-atomic="true"></div>

    <!-- Scripts -->
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="https://unpkg.com/alpinejs@3.13.5/dist/cdn.min.js" defer></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="/static/js/components/executive-dashboard.js" type="module"></script>
    <script src="/static/js/accessibility-enhancements.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw-enhanced.js')
                    .then(registration => console.log('SW registered:', registration))
                    .catch(error => console.log('SW registration failed:', error));
            });
        }
    </script>
</body>
</html>